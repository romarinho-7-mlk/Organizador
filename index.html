<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SuportAdd</title>
  <style>
    :root{--bg:#3e4754;--card:#04364bfb;--muted:#048487;--accent:#06b6d4;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui;color:#002e37;background:linear-gradient(180deg,#cfe9f6 0%, hsl(182, 100%, 95%) 100%)}
    .app{display:grid;grid-template-columns:280px 1fr;gap:20px;height:100vh;padding:20px}
    .sidebar{background:var(--card);border-radius:12px;padding:14px;display:flex;flex-direction:column;gap:12px}
    .logo{font-weight:700;color:var(--accent);font-size:18px}
    .pages{flex:1;overflow:auto}
    .page{background:var(--glass);padding:8px;border-radius:8px;margin-bottom:8px;cursor:pointer}
    .page.active{outline:2px solid rgba(255, 3, 3, 0.069)}
    .new-page{display:flex;gap:8px}
    .btn{background:white;border:1px solid rgba(116, 116, 116, 0.963);padding:8px;border-radius:8px;color:var(--muted);cursor:pointer}
    .main{padding:18px;}
    .card{background:#f0f9f9;padding:16px;border-radius:12px;box-shadow:0 6px 18px rgba(1, 1, 1, 0.6)}
    header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
    h1{margin:0;font-size:20px}
    .controls{display:flex;gap:8px}

    /* Botões */
    .btn {
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      color: white;
      cursor: pointer;
      font-weight: bold;
      background: linear-gradient(to right, #007bff, #0056b3);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: background 0.3s ease;
    }
    .btn:hover { background: linear-gradient(to right, #0056b3, #007bff); }
    .btn:active { transform: translateY(1px); }
    .danger { background: #dc3545; color: white; }
    .danger:hover { background: #c82333; }

    /* GRID */
    .blocks { display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; }
    .block, .attach-item {
      background:#01646415;
      padding:12px;
      border-radius:12px;
      box-shadow:0 2px 6px rgba(0, 0, 0, 0.114);
      display:flex;
      flex-direction:column;
      gap:8px;
      cursor: pointer;
    }
    .block h3, .block p { margin: 0; }

    .title-input {
      font-weight:bold;
      border:1px solid #ccc;
      padding:6px;
      border-radius:8px;
    }

    .attachments { display:flex; flex-direction:column; gap:6px; }
    .small{font-size:13px;color:var(--muted)}
    
    input[type=file]{display:none}
    @media(max-width:860px){
      .app{grid-template-columns:1fr;grid-auto-rows:auto;overflow:auto;height:auto}
      .sidebar{order:2}
      .blocks{grid-template-columns:1fr}
    }

    /* Modal */
    dialog {
      border: none;
      border-radius: 12px;
      padding: 24px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
      max-width: 900px;
      width: 90%;
      background: #fff;
    }
    dialog::backdrop { background: rgba(0, 0, 0, 0.5); }
    .modal-content { display: flex; flex-direction: column; gap: 16px; }
    .modal-content input, .modal-content .btn { width: 100%; }
    .modal-buttons { display: flex; justify-content: flex-end; gap: 8px; }

    /* Anexos */
    #editModalFileList, #modalFileList {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
    }
    .attach-item img { max-width: 100%; height: auto; margin-bottom: 8px; border-radius: 6px; }
    .attach-item .file-name { flex: 1; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .attach-item .actions { display: flex; gap: 8px; }
  </style>

  <!-- Quill Styles -->
  <link href="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.snow.css" rel="stylesheet" />
</head>
<body>
  <div class="app">
    <aside class="sidebar card">
      <div class="logo">Suport - ADD </div>
      <div class="pages" id="pages"></div>
      <div class="new-page">
        <input id="newPageInput" class="btn" placeholder="Nome da página" />
        <button id="addPageBtn" class="btn">Criar</button>
      </div>
    </aside>

    <main class="main">
      <div class="card">
        <header>
          <h1 id="pageTitle">Página</h1>
          <input type="text" id="searchBar" class="btn" placeholder="Pesquisar..." />
          <div class="controls">
            <button id="addTextBtn" class="btn">Adicionar bloco de texto</button>
            <button id="deletePageBtn" class="btn danger">Excluir página</button>
            <button id="logoutBtn" class="btn danger">Sair</button>
          </div>
        </header>
        <section class="blocks" id="blocksContainer"></section>
      </div>
    </main>
  </div>

  <!-- Modal Novo Bloco -->
  <dialog id="newBlockModal">
    <div class="modal-content">
      <h2>Novo Bloco de Texto</h2>
      <input type="text" id="modalTitle" placeholder="Novo tópico" class="title-input" />
      <div id="modalEditor"></div>
      <div class="file-upload">
        <label class="btn">Adicionar arquivos
          <input type="file" id="modalFiles" multiple style="display: none;" />
        </label>
        <div id="modalFileList"></div>
      </div>
      <div class="modal-buttons">
        <button id="closeModalBtn" class="btn">Cancelar</button>
        <button id="saveModalBtn" class="btn">Salvar</button>
      </div>
    </div>
  </dialog>

  <!-- Modal Editar Bloco -->
  <dialog id="editBlockModal">
    <div class="modal-content">
      <input type="hidden" id="editModalBlockId" />
      <h2>Detalhes do Bloco</h2>
      <input type="text" id="editModalTitleInput" class="title-input" />
      <div id="editModalEditor"></div>
      <div class="file-upload">
        <label class="btn">Adicionar arquivos
          <input type="file" id="editModalFilesInput" multiple style="display: none;" />
        </label>
      </div>
      <div id="editModalFileList"></div>
      <div class="modal-buttons">
        <button id="closeEditModalBtn" class="btn">Fechar</button>
        <button id="saveEditModalBtn" class="btn">Salvar Alterações</button>
        <button id="deleteBtn" class="btn danger">Excluir Bloco</button>
      </div>
    </div>
  </dialog>

  <!-- Quill + Plugins -->
  <script src="https://cdn.jsdelivr.net/npm/quill@2.0.3/dist/quill.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/quill-image-resize-module@3.0.0/image-resize.min.js"></script>

  <script type="module">
    import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

    const SUPABASE_URL = "https://ybpyncfnzfrobqcuiyqr.supabase.co";
    const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlicHluY2ZuemZyb2JxY3VpeXFyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTgxMzY0MDUsImV4cCI6MjA3MzcxMjQwNX0.s_vaIyn8kDkORC2nW-aOgk_4f3ZlsGNqxjgPGFfjVBc";
    const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

    let quillNewBlock, quillEditBlock;
    window.addEventListener("DOMContentLoaded", () => {
      quillNewBlock = new Quill('#modalEditor', {
        theme: 'snow',
        placeholder: 'Adicionar texto aqui...',
        modules: {
          toolbar: [['bold','italic','underline'],[{list:'ordered'},{list:'bullet'}],['link','image']],
          imageResize: { modules: ['Resize','DisplaySize','Toolbar'] }
        }
      });
      quillEditBlock = new Quill('#editModalEditor', {
        theme: 'snow',
        placeholder: 'Editar conteúdo...',
        modules: {
          toolbar: [['bold','italic','underline'],[{list:'ordered'},{list:'bullet'}],['link','image']],
          imageResize: { modules: ['Resize','DisplaySize','Toolbar'] }
        }
      });
    });

    // ⚡️ O restante do script continua igual ao que já te passei (Supabase, blocos, anexos, etc.)
    // Só substituímos os editores para usar Quill com redimensionamento de imagens
  </script>
</body>
</html>
